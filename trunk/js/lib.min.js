jun.StringGenerator=function(a,b){var c="";b.indexOf("a")>-1&&(c+="abcdefghijklmnopqrstuvwxyz"),b.indexOf("A")>-1&&(c+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),b.indexOf("#")>-1&&(c+="0123456789"),b.indexOf("!")>-1&&(c+="~`!@#$%^&*()_+-={}[]:\";'<>?,./|\\");var d="";for(var e=a;e>0;--e)d+=c[Math.round(Math.random()*(c.length-1))];return d},jun.EncryptPass=function(a){for(var b=0;b<13;b++)a=b64_sha512(a);return a},Ext.ux.NumericField=function(a){var b={style:"text-align:right;"};Ext.ux.NumericField.superclass.constructor.call(this,Ext.apply(b,a)),this.useThousandSeparator&&this.decimalSeparator==","&&Ext.isEmpty(a.thousandSeparator)?this.thousandSeparator=".":this.allowDecimals&&this.thousandSeparator=="."&&Ext.isEmpty(a.decimalSeparator)&&(this.decimalSeparator=","),this.onFocus=this.onFocus.createSequence(this.onFocus)},Ext.extend(Ext.ux.NumericField,Ext.form.NumberField,{currencySymbol:null,useThousandSeparator:!0,thousandSeparator:",",alwaysDisplayDecimals:!1,setValue:function(a){Ext.ux.NumericField.superclass.setValue.call(this,a),this.setRawValue(this.getFormattedValue(this.getValue()))},getFormattedValue:function(a){if(Ext.isEmpty(a)||!this.hasFormat())return a;var b=null;a=(b=a<0)?a*-1:a,a=this.allowDecimals&&this.alwaysDisplayDecimals?a.toFixed(this.decimalPrecision):a;if(this.useThousandSeparator){if(this.useThousandSeparator&&Ext.isEmpty(this.thousandSeparator))throw"NumberFormatException: invalid thousandSeparator, property must has a valid character.";if(this.thousandSeparator==this.decimalSeparator)throw"NumberFormatException: invalid thousandSeparator, thousand separator must be different from decimalSeparator.";var a=String(a),c=a.split(".");c[1]=c[1]?c[1]:null;var d=c[0],e=/(\d+)(\d{3})/,f=this.thousandSeparator;while(e.test(d))d=d.replace(e,"$1"+f+"$2");a=d+(c[1]?this.decimalSeparator+c[1]:"")}return String.format("{0}{1}{2}",b?"-":"",Ext.isEmpty(this.currencySymbol)?"":this.currencySymbol+" ",a)},parseValue:function(a){return Ext.ux.NumericField.superclass.parseValue.call(this,this.removeFormat(a))},removeFormat:function(a){return Ext.isEmpty(a)||!this.hasFormat()?a:(a=a.replace(this.currencySymbol+" ",""),a=this.useThousandSeparator?a.replace(new RegExp("["+this.thousandSeparator+"]","g"),""):a,a)},getErrors:function(a){return Ext.ux.NumericField.superclass.getErrors.call(this,this.removeFormat(a))},hasFormat:function(){return this.decimalSeparator!="."||this.useThousandSeparator==1||!Ext.isEmpty(this.currencySymbol)||this.alwaysDisplayDecimals},onFocus:function(){this.setRawValue(this.removeFormat(this.getRawValue()))}}),Ext.reg("numericfield",Ext.ux.NumericField),Ext.ns("Ext.ux.form"),Ext.ux.form.XDateField=Ext.extend(Ext.form.DateField,{submitFormat:"Y-m-d",onRender:function(){Ext.ux.form.XDateField.superclass.onRender.apply(this,arguments);var a=this.name||this.el.dom.name;this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:a,value:this.formatHiddenDate(this.parseDate(this.value))}),this.hiddenName=a,this.el.dom.removeAttribute("name"),this.el.on({keyup:{scope:this,fn:this.updateHidden},blur:{scope:this,fn:this.updateHidden}},Ext.isIE?"after":"before"),this.setValue=this.setValue.createSequence(this.updateHidden)},onDisable:function(){Ext.ux.form.XDateField.superclass.onDisable.apply(this,arguments),this.hiddenField&&this.hiddenField.dom.setAttribute("disabled","disabled")},onEnable:function(){Ext.ux.form.XDateField.superclass.onEnable.apply(this,arguments),this.hiddenField&&this.hiddenField.dom.removeAttribute("disabled")},formatHiddenDate:function(a){return Ext.isDate(a)?"timestamp"===this.submitFormat?a.getTime()/1e3:Ext.util.Format.date(a,this.submitFormat):a},updateHidden:function(){this.hiddenField.dom.value=this.formatHiddenDate(this.getValue())}}),Ext.reg("xdatefield",Ext.ux.form.XDateField),jun.example=function(){function a(a,b){return['<div class="msg">','<div class="x-box-tl"><div class="x-box-tr"><div class="x-box-tc"></div></div></div>','<div class="x-box-ml"><div class="x-box-mr"><div class="x-box-mc"><h3>',a,"</h3>",b,"</div></div></div>",'<div class="x-box-bl"><div class="x-box-br"><div class="x-box-bc"></div></div></div>',"</div>"].join("")}var b;return{msg:function(c,d){b||(b=Ext.DomHelper.insertFirst(document.body,{id:"msg-div"},!0)),b.alignTo(document,"t-t");var e=String.format.apply(String,Array.prototype.slice.call(arguments,1)),f=Ext.DomHelper.append(b,{html:a(c,e)},!0);f.slideIn("t").pause(5).ghost("t",{remove:!0})},init:function(){var a=Ext.get("lib-bar");a&&a.show()}}}(),jun.example.shortBogusMarkup="<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Sed metus nibh, sodales a, porta at, vulputate eget, dui. Pellentesque ut nisl. Maecenas tortor turpis, interdum non, sodales non, iaculis ac, lacus. Vestibulum auctor, tortor quis iaculis malesuada, libero lectus bibendum purus, sit amet tincidunt quam turpis vel lacus. In pellentesque nisl non sem. Suspendisse nunc sem, pretium eget, cursus a, fringilla vel, urna.",jun.example.bogusMarkup="<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Sed metus nibh, sodales a, porta at, vulputate eget, dui. Pellentesque ut nisl. Maecenas tortor turpis, interdum non, sodales non, iaculis ac, lacus. Vestibulum auctor, tortor quis iaculis malesuada, libero lectus bibendum purus, sit amet tincidunt quam turpis vel lacus. In pellentesque nisl non sem. Suspendisse nunc sem, pretium eget, cursus a, fringilla vel, urna.<br/><br/>Aliquam commodo ullamcorper erat. Nullam vel justo in neque porttitor laoreet. Aenean lacus dui, consequat eu, adipiscing eget, nonummy non, nisi. Morbi nunc est, dignissim non, ornare sed, luctus eu, massa. Vivamus eget quam. Vivamus tincidunt diam nec urna. Curabitur velit.</p>",jun.bulan=new Ext.data.ArrayStore({fields:["noBulan","namaBulan"],data:[["1","Januari"],["2","Februari"],["3","Maret"],["4","April"],["5","Mei"],["6","Juni"],["7","Juli"],["8","Agustus"],["9","September"],["10","Oktober"],["11","November"],["12","Desember"]]}),jun.comboBulan=Ext.extend(Ext.form.ComboBox,{displayField:"namaBulan",valueField:"noBulan",mode:"local",forceSelection:!0,emptyText:"Pilih bulan...",selectOnFocus:!0,initComponent:function(){this.store=jun.bulan,jun.comboBulan.superclass.initComponent.call(this)}}),jun.methodPay=new Ext.data.ArrayStore({fields:["payVal","payName"],data:[["Tunai","Tunai"],["Debet","Debet"],["Transfer","Transfer"],["Cek","Cek"],["Bilyet Giro (BG)","Bilyet Giro (BG)"]]}),jun.comboPayment=Ext.extend(Ext.form.ComboBox,{displayField:"payName",valueField:"payVal",typeAhead:!0,mode:"local",forceSelection:!0,triggerAction:"all",emptyText:"Pilih cara bayar...",selectOnFocus:!0,initComponent:function(){this.store=jun.methodPay,jun.comboPayment.superclass.initComponent.call(this)}}),jun.Gender=new Ext.data.ArrayStore({fields:["code","desc"],data:[["M","Laki-laki"],["F","Perempuan"]]}),jun.cmbGender=Ext.extend(Ext.form.ComboBox,{displayField:"desc",valueField:"code",typeAhead:!0,mode:"local",forceSelection:!0,triggerAction:"all",emptyText:"Pilih jenis kelamin...",selectOnFocus:!0,name:"gender",hiddenName:"gender",hiddenValue:"gender",initComponent:function(){this.store=jun.Gender,jun.comboPayment.superclass.initComponent.call(this)}}),jun.active=new Ext.data.ArrayStore({fields:["activeVal","activeName"],data:[[0,"Aktif"],[1,"Non Aktif"]]}),jun.comboActive=Ext.extend(Ext.form.ComboBox,{displayField:"activeName",valueField:"activeVal",typeAhead:!0,mode:"local",forceSelection:!0,typeAhead:!0,triggerAction:"all",name:"inactive",hiddenName:"inactive",hiddenValue:"inactive",emptyText:"Pilih status...",selectOnFocus:!0,initComponent:function(){this.store=jun.active,jun.comboActive.superclass.initComponent.call(this)}}),jun.renderActive=function(a,b,c){return a==1?"Non Aktif":"Aktif"},Ext.onReady(jun.example.init,jun.example);var Cookies={};Cookies.set=function(a,b){var c=arguments,d=arguments.length,e=d>2?c[2]:null,f=d>3?c[3]:"/",g=d>4?c[4]:null,h=d>5?c[5]:!1;document.cookie=a+"="+escape(b)+(e==null?"":"; expires="+e.toGMTString())+(f==null?"":"; path="+f)+(g==null?"":"; domain="+g)+(h==1?"; secure":"")},Cookies.get=function(a){var b=a+"=",c=b.length,d=document.cookie.length,e=0,f=0;while(e<d){f=e+c;if(document.cookie.substring(e,f)==b)return Cookies.getCookieVal(f);e=document.cookie.indexOf(" ",e)+1;if(e==0)break}return null},Cookies.clear=function(a){Cookies.get(a)&&(document.cookie=a+"="+"; expires=Thu, 01-Jan-70 00:00:01 GMT")},Cookies.getCookieVal=function(a){var b=document.cookie.indexOf(";",a);return b==-1&&(b=document.cookie.length),unescape(document.cookie.substring(a,b))},Ext.ux.Spinner=Ext.extend(Ext.util.Observable,{incrementValue:1,alternateIncrementValue:5,triggerClass:"x-form-spinner-trigger",splitterClass:"x-form-spinner-splitter",alternateKey:Ext.EventObject.shiftKey,defaultValue:0,accelerate:!1,constructor:function(a){Ext.ux.Spinner.superclass.constructor.call(this,a),Ext.apply(this,a),this.mimicing=!1},init:function(a){this.field=a,a.afterMethod("onRender",this.doRender,this),a.afterMethod("onEnable",this.doEnable,this),a.afterMethod("onDisable",this.doDisable,this),a.afterMethod("afterRender",this.doAfterRender,this),a.afterMethod("onResize",this.doResize,this),a.afterMethod("onFocus",this.doFocus,this),a.beforeMethod("onDestroy",this.doDestroy,this)},doRender:function(a,b){var c=this.el=this.field.getEl(),d=this.field;d.wrap?this.wrap=d.wrap.addClass("x-form-field-wrap"):d.wrap=this.wrap=c.wrap({cls:"x-form-field-wrap"}),this.trigger=this.wrap.createChild({tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.triggerClass}),d.width||this.wrap.setWidth(c.getWidth()+this.trigger.getWidth()),this.splitter=this.wrap.createChild({tag:"div",cls:this.splitterClass,style:"width:13px; height:2px;"}),this.splitter.setRight(Ext.isIE?1:2).setTop(10).show(),this.proxy=this.trigger.createProxy("",this.splitter,!0),this.proxy.addClass("x-form-spinner-proxy"),this.proxy.setStyle("left","0px"),this.proxy.setSize(14,1),this.proxy.hide(),this.dd=new Ext.dd.DDProxy(this.splitter.dom.id,"SpinnerDrag",{dragElId:this.proxy.id}),this.initTrigger(),this.initSpinner()},doAfterRender:function(){var a;Ext.isIE&&this.el.getY()!=(a=this.trigger.getY())&&(this.el.position(),this.el.setY(a))},doEnable:function(){this.wrap&&(this.disabled=!1,this.wrap.removeClass(this.field.disabledClass))},doDisable:function(){this.wrap&&(this.disabled=!0,this.wrap.addClass(this.field.disabledClass),this.el.removeClass(this.field.disabledClass))},doResize:function(a,b){typeof a=="number"&&this.el.setWidth(a-this.trigger.getWidth()),this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth())},doFocus:function(){this.mimicing||(this.wrap.addClass("x-trigger-wrap-focus"),this.mimicing=!0,Ext.get(Ext.isIE?document.body:document).on("mousedown",this.mimicBlur,this,{delay:10}),this.el.on("keydown",this.checkTab,this))},checkTab:function(a){a.getKey()==a.TAB&&this.triggerBlur()},mimicBlur:function(a){!this.wrap.contains(a.target)&&this.field.validateBlur(a)&&this.triggerBlur()},triggerBlur:function(){this.mimicing=!1,Ext.get(Ext.isIE?document.body:document).un("mousedown",this.mimicBlur,this),this.el.un("keydown",this.checkTab,this),this.field.beforeBlur(),this.wrap.removeClass("x-trigger-wrap-focus"),this.field.onBlur.call(this.field)},initTrigger:function(){this.trigger.addClassOnOver("x-form-trigger-over"),this.trigger.addClassOnClick("x-form-trigger-click")},initSpinner:function(){this.field.addEvents({spin:!0,spinup:!0,spindown:!0}),this.keyNav=new Ext.KeyNav(this.el,{up:function(a){a.preventDefault(),this.onSpinUp()},down:function(a){a.preventDefault(),this.onSpinDown()},pageUp:function(a){a.preventDefault(),this.onSpinUpAlternate()},pageDown:function(a){a.preventDefault(),this.onSpinDownAlternate()},scope:this}),this.repeater=new Ext.util.ClickRepeater(this.trigger,{accelerate:this.accelerate}),this.field.mon(this.repeater,"click",this.onTriggerClick,this,{preventDefault:!0}),this.field.mon(this.trigger,{mouseover:this.onMouseOver,mouseout:this.onMouseOut,mousemove:this.onMouseMove,mousedown:this.onMouseDown,mouseup:this.onMouseUp,scope:this,preventDefault:!0}),this.field.mon(this.wrap,"mousewheel",this.handleMouseWheel,this),this.dd.setXConstraint(0,0,10),this.dd.setYConstraint(1500,1500,10),this.dd.endDrag=this.endDrag.createDelegate(this),this.dd.startDrag=this.startDrag.createDelegate(this),this.dd.onDrag=this.onDrag.createDelegate(this)},onMouseOver:function(){if(this.disabled)return;var a=this.getMiddle();this.tmpHoverClass=Ext.EventObject.getPageY()<a?"x-form-spinner-overup":"x-form-spinner-overdown",this.trigger.addClass(this.tmpHoverClass)},onMouseOut:function(){this.trigger.removeClass(this.tmpHoverClass)},onMouseMove:function(){if(this.disabled)return;var a=this.getMiddle();!(Ext.EventObject.getPageY()>a&&this.tmpHoverClass=="x-form-spinner-overup"||Ext.EventObject.getPageY()<a&&this.tmpHoverClass=="x-form-spinner-overdown")},onMouseDown:function(){if(this.disabled)return;var a=this.getMiddle();this.tmpClickClass=Ext.EventObject.getPageY()<a?"x-form-spinner-clickup":"x-form-spinner-clickdown",this.trigger.addClass(this.tmpClickClass)},onMouseUp:function(){this.trigger.removeClass(this.tmpClickClass)},onTriggerClick:function(){if(this.disabled||this.el.dom.readOnly)return;var a=this.getMiddle(),b=Ext.EventObject.getPageY()<a?"Up":"Down";this["onSpin"+b]()},getMiddle:function(){var a=this.trigger.getTop(),b=this.trigger.getHeight(),c=a+b/2;return c},isSpinnable:function(){return this.disabled||this.el.dom.readOnly?(Ext.EventObject.preventDefault(),!1):!0},handleMouseWheel:function(a){if(this.wrap.hasClass("x-trigger-wrap-focus")==0)return;var b=a.getWheelDelta();b>0?(this.onSpinUp(),a.stopEvent()):b<0&&(this.onSpinDown(),a.stopEvent())},startDrag:function(){this.proxy.show(),this._previousY=Ext.fly(this.dd.getDragEl()).getTop()},endDrag:function(){this.proxy.hide()},onDrag:function(){if(this.disabled)return;var a=Ext.fly(this.dd.getDragEl()).getTop(),b="";this._previousY>a&&(b="Up"),this._previousY<a&&(b="Down"),b!=""&&this["onSpin"+b](),this._previousY=a},onSpinUp:function(){if(this.isSpinnable()==0)return;if(Ext.EventObject.shiftKey==1){this.onSpinUpAlternate();return}this.spin(!1,!1),this.field.fireEvent("spin",this),this.field.fireEvent("spinup",this)},onSpinDown:function(){if(this.isSpinnable()==0)return;if(Ext.EventObject.shiftKey==1){this.onSpinDownAlternate();return}this.spin(!0,!1),this.field.fireEvent("spin",this),this.field.fireEvent("spindown",this)},onSpinUpAlternate:function(){if(this.isSpinnable()==0)return;this.spin(!1,!0),this.field.fireEvent("spin",this),this.field.fireEvent("spinup",this)},onSpinDownAlternate:function(){if(this.isSpinnable()==0)return;this.spin(!0,!0),this.field.fireEvent("spin",this),this.field.fireEvent("spindown",this)},spin:function(a,b){var c=parseFloat(this.field.getValue()),d=b==1?this.alternateIncrementValue:this.incrementValue;a==1?c-=d:c+=d,c=isNaN(c)?this.defaultValue:c,c=this.fixBoundries(c),this.field.setRawValue(c)},fixBoundries:function(a){var b=a;return this.field.minValue!=undefined&&b<this.field.minValue&&(b=this.field.minValue),this.field.maxValue!=undefined&&b>this.field.maxValue&&(b=this.field.maxValue),this.fixPrecision(b)},fixPrecision:function(a){var b=isNaN(a);return!this.field.allowDecimals||this.field.decimalPrecision==-1||b||!a?b?"":a:parseFloat(parseFloat(a).toFixed(this.field.decimalPrecision))},doDestroy:function(){this.trigger&&this.trigger.remove(),this.wrap&&(this.wrap.remove(),delete this.field.wrap),this.splitter&&this.splitter.remove(),this.dd&&(this.dd.unreg(),this.dd=null),this.proxy&&this.proxy.remove(),this.repeater&&this.repeater.purgeListeners(),this.mimicing&&Ext.get(Ext.isIE?document.body:document).un("mousedown",this.mimicBlur,this)}}),Ext.form.Spinner=Ext.ux.Spinner,Ext.ux.form.SpinnerField=Ext.extend(Ext.form.NumberField,{actionMode:"wrap",deferHeight:!0,autoSize:Ext.emptyFn,onBlur:Ext.emptyFn,adjustSize:Ext.BoxComponent.prototype.adjustSize,constructor:function(a){var b=Ext.copyTo({},a,"incrementValue,alternateIncrementValue,accelerate,defaultValue,triggerClass,splitterClass"),c=this.spinner=new Ext.ux.Spinner(b),d=a.plugins?Ext.isArray(a.plugins)?a.plugins.push(c):[a.plugins,c]:c;Ext.ux.form.SpinnerField.superclass.constructor.call(this,Ext.apply(a,{plugins:d}))},getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},alignErrorIcon:function(){this.wrap&&this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])},validateBlur:function(){return!0}}),Ext.reg("spinnerfield",Ext.ux.form.SpinnerField),Ext.form.SpinnerField=Ext.ux.form.SpinnerField,Ext.namespace("Ext.ux.grid"),Ext.ux.grid.GridHeaderFilters=function(a){a&&Ext.apply(this,a)},Ext.extend(Ext.ux.grid.GridHeaderFilters,Ext.util.Observable,{fieldHeight:22,fieldPadding:1,highlightOnFilter:!0,highlightColor:"yellow",highlightCls:null,stateful:!0,applyMode:"auto",filters:null,filtersInitMode:"replace",ensureFilteredVisible:!0,cfgFilterInit:!1,containerConfig:null,labelWidth:50,fcc:null,filterFields:null,filterContainers:null,filterContainerCls:"x-ghf-filter-container",init:function(a){this.grid=a;var b=this.grid.getView();b.updateHeaders=b.updateHeaders.createSequence(function(){this.renderFilters.call(this)},this).createInterceptor(function(){return this.destroyFilters.call(this),!0},this),this.grid.on({scope:this,render:this.onRender,resize:this.onResize,columnresize:this.onColResize,reconfigure:this.onReconfigure,beforedestroy:this.destroyFilters}),this.stateful&&(this.grid.on("beforestatesave",this.saveFilters,this),this.grid.on("beforestaterestore",this.loadFilters,this)),this.grid.getColumnModel().on("hiddenchange",this.onColHidden,this),this.grid.addEvents("filterupdate"),this.addEvents({render:!0}),this.cfgFilterInit=Ext.isDefined(this.filters)&&this.filters!==null,this.filters||(this.filters={}),this.configure(this.grid.getColumnModel()),Ext.ux.grid.GridHeaderFilters.superclass.constructor.call(this),this.stateful&&(Ext.isArray(this.grid.stateEvents)||(this.grid.stateEvents=[]),this.grid.stateEvents.push("filterupdate")),Ext.apply(this.grid,{headerFilters:this,getHeaderFilter:function(a){return this.headerFilters?this.headerFilters.filters[a]:null},setHeaderFilter:function(a,b){if(!this.headerFilters)return;var c={};c[a]=b,this.setHeaderFilters(c)},setHeaderFilters:function(a,b,c){if(!this.headerFilters)return;b&&this.resetHeaderFilters(!1);if(arguments.length<3)var c=!0;var d=!1;for(var e in a)if(this.headerFilters.filterFields[e]){var f=this.headerFilters.filterFields[e];this.headerFilters.setFieldValue(f,a[e]),this.headerFilters.applyFilter(f,!1),d=!0}d&&c&&this.headerFilters.storeReload()},getHeaderFilterField:function(a){if(!this.headerFilters)return;return this.headerFilters.filterFields[a]?this.headerFilters.filterFields[a]:null},resetHeaderFilters:function(a){if(!this.headerFilters)return;if(arguments.length==0)var a=!0;for(var b in this.headerFilters.filterFields){var c=this.headerFilters.filterFields[b];Ext.isFunction(c.clearValue)?c.clearValue():this.headerFilters.setFieldValue(c,""),this.headerFilters.applyFilter(c,!1)}a&&this.headerFilters.storeReload()},applyHeaderFilters:function(a){if(arguments.length==0)var a=!0;this.headerFilters.applyFilters(a)}})},configure:function(a){var b=a.getColumnsBy(function(a){return Ext.isObject(a.filter)||Ext.isArray(a.filter)?!0:!1});this.fcc={};for(var c=0;c<b.length;c++){var d=b[c],e=d.filter;Ext.isArray(e)||(e=[e]);for(var f=0;f<e.length;f++){var g=Ext.apply({filterName:f>0?d.dataIndex+f:d.dataIndex},e[f]);Ext.apply(g,{columnId:d.id,dataIndex:d.dataIndex,hideLabel:Ext.isEmpty(g.fieldLabel),anchor:"100%"}),!this.cfgFilterInit&&!Ext.isEmpty(g.value)&&(this.filters[g.filterName]=Ext.isFunction(g.filterEncoder)?g.filterEncoder.call(this,g.value):g.value),delete g.value,g.applyFilterEvent?(g.listeners={scope:this},g.listeners[g.applyFilterEvent]=function(a){this.applyFilter(a)},delete g.applyFilterEvent):this.applyMode==="auto"||this.applyMode==="change"||Ext.isEmpty(this.applyMode)?g.listeners={change:function(a){var b=a.getXType();if(b=="combo"||b=="datefield")return;this.applyFilter(a)},specialkey:function(a,b){b.stopPropagation(),b.getKey()==b.ENTER&&a.el.dom.blur()},select:function(a){this.applyFilter(a)},scope:this}:this.applyMode==="enter"&&(g.listeners={specialkey:function(a,b){b.stopPropagation(),b.getKey()==b.ENTER&&this.applyFilters()},scope:this});var h=this.fcc[g.columnId];h||(h={cls:this.filterContainerCls,border:!1,bodyBorder:!1,labelSeparator:"",labelWidth:this.labelWidth,layout:"form",style:{},items:[]},this.containerConfig&&Ext.apply(h,this.containerConfig),this.fcc[g.columnId]=h),h.items.push(g)}}},renderFilterContainer:function(a,b){this.filterContainers||(this.filterContainers={});var c=this.grid.getColumnModel().getIndexById(a),d=this.grid.getView().getHeaderCell(c);d=Ext.get(d),Ext.isGecko&&(d.dom.style.MozUserSelect="text"),d.dom.style.verticalAlign="top",b.width=d.getWidth()-3;var e=new Ext.Container(b);e.render(d),this.filterContainers[a]=e;var f=0;this.filterFields||(this.filterFields={});var g=e.findBy(function(a){return!Ext.isEmpty(a.filterName)});if(!Ext.isEmpty(g))for(var h=0;h<g.length;h++){var i=g[h].filterName;this.filterFields[i]=g[h],f+=g[h].getHeight()}return e},renderFilters:function(){if(!this.fcc)return;for(var a in this.fcc)this.renderFilterContainer(a,this.fcc[a]);this.setFilters(this.filters),this.highlightFilters(this.isFiltered())},onRender:function(){this.renderFilters(),this.isFiltered()&&this.applyFilters(!1),this.fireEvent("render",this)},getFilterField:function(a){return this.filterFields?this.filterFields[a]:null},setFilters:function(a,b){this.filters=a;if(this.filters&&this.filterFields){for(var c in this.filters)this.filterFields[c]||delete this.filters[c];for(var c in this.filterFields){var d=this.filterFields[c],e=this.filters[d.filterName];Ext.isEmpty(e)?b&&this.setFieldValue(d,""):this.setFieldValue(d,e)}}},onColResize:function(a,b){if(!this.filterContainers)return;var c=this.grid.getColumnModel().getColumnId(a),d=this.filterContainers[c];if(d){isNaN(b)&&(b=0);var e=b<3?0:b-3;d.setWidth(e),d.doLayout(!1,!0)}},onResize:function(){var a=this.grid.getColumnModel().getColumnCount();for(var b=0;b<a;b++){var c=this.grid.getView().getHeaderCell(b);c=Ext.get(c),this.onColResize(b,c.getWidth())}},onColHidden:function(a,b,c){if(c)return;var d=this.grid.getColumnModel().getColumnWidth(b);this.onColResize(b,d)},onReconfigure:function(a,b,c){this.destroyFilters(),this.configure(c),this.renderFilters()},saveFilters:function(a,b){var c={};for(var d in this.filters)c[d]=this.filters[d];return b.gridHeaderFilters=c,!0},loadFilters:function(a,b){var c=b.gridHeaderFilters;c&&(this.cfgFilterInit?this.filtersInitMode==="merge"&&Ext.apply(c,this.filters):this.filters=c)},isFiltered:function(){for(var a in this.filters)if(!Ext.isEmpty(this.filters[a]))return!0;return!1},highlightFilters:function(a){if(!this.highlightOnFilter)return;if(!this.filterContainers)return;if(!this.grid.getView().mainHd)return;var b=this.grid.getView().mainHd.child(".x-grid3-hd-row");Ext.isEmpty(this.highlightCls)?b.setStyle("background-color",a?this.highlightColor:""):a?b.addClass(this.highlightCls):b.removeClass(this.highlightCls)},getFieldValue:function(a){return Ext.isFunction(a.filterEncoder)?a.filterEncoder.call(a,a.getValue()):a.getValue()},setFieldValue:function(a,b){Ext.isFunction(a.filterDecoder)&&(b=a.filterDecoder.call(a,b)),a.setValue(b)},applyFilter:function(a,b){arguments.length<2&&(b=!0);if(!a)return;if(!a.isValid())return;if(a.disabled&&!Ext.isDefined(this.grid.store.baseParams[a.filterName]))return;var c=this.getFieldValue(a);if(a.disabled||Ext.isEmpty(c))delete this.grid.store.baseParams[a.filterName],delete this.filters[a.filterName];else{this.grid.store.baseParams[a.filterName]=c,this.filters[a.filterName]=c;if(this.ensureFilteredVisible){var d=this.grid.getColumnModel().getIndexById(a.columnId);d>=0&&this.grid.getColumnModel().isHidden(d)&&this.grid.getColumnModel().setHidden(d,!1)}}this.highlightFilters(this.isFiltered()),this.grid.fireEvent("filterupdate",a.filterName,c,a),b&&this.storeReload()},applyFilters:function(a){arguments.length<1&&(a=!0);for(var b in this.filterFields)this.applyFilter(this.filterFields[b],!1);a&&this.storeReload()},storeReload:function(){if(!this.grid.store.lastOptions)return;var a={start:0};this.grid.store.lastOptions.params&&this.grid.store.lastOptions.params.limit&&(a.limit=this.grid.store.lastOptions.params.limit),this.grid.store.load({params:a})},getFilterContainer:function(a){return this.filterContainers?this.filterContainers[a]:null},destroyFilters:function(){if(this.filterFields)for(var a in this.filterFields)Ext.destroy(this.filterFields[a]),delete this.filterFields[a];if(this.filterContainers)for(var a in this.filterContainers)Ext.destroy(this.filterContainers[a]),delete this.filterContainers[a]}}),Ext.namespace("Ext.ux.grid"),Ext.ux.grid.GridHeaderFilters=function(a){a&&Ext.apply(this,a)},Ext.extend(Ext.ux.grid.GridHeaderFilters,Ext.util.Observable,{fieldHeight:22,fieldPadding:1,highlightOnFilter:!1,highlightColor:"yellow",highlightCls:null,stateful:!0,applyMode:"auto",filters:null,filtersInitMode:"replace",ensureFilteredVisible:!0,cfgFilterInit:!1,containerConfig:null,labelWidth:50,fcc:null,filterFields:null,filterContainers:null,filterContainerCls:"x-ghf-filter-container",init:function(a){this.grid=a;var b=this.grid.getView();b.updateHeaders=b.updateHeaders.createSequence(function(){this.renderFilters.call(this)},this).createInterceptor(function(){return this.destroyFilters.call(this),!0},this),this.grid.on({scope:this,render:this.onRender,resize:this.onResize,columnresize:this.onColResize,reconfigure:this.onReconfigure,beforedestroy:this.destroyFilters}),this.stateful&&(this.grid.on("beforestatesave",this.saveFilters,this),this.grid.on("beforestaterestore",this.loadFilters,this)),this.grid.getColumnModel().on("hiddenchange",this.onColHidden,this),this.grid.addEvents("filterupdate"),this.addEvents({render:!0}),this.cfgFilterInit=Ext.isDefined(this.filters)&&this.filters!==null,this.filters||(this.filters={}),this.configure(this.grid.getColumnModel()),Ext.ux.grid.GridHeaderFilters.superclass.constructor.call(this),this.stateful&&(Ext.isArray(this.grid.stateEvents)||(this.grid.stateEvents=[]),this.grid.stateEvents.push("filterupdate")),Ext.apply(this.grid,{headerFilters:this,getHeaderFilter:function(a){return this.headerFilters?this.headerFilters.filters[a]:null},setHeaderFilter:function(a,b){if(!this.headerFilters)return;var c={};c[a]=b,this.setHeaderFilters(c)},setHeaderFilters:function(a,b,c){if(!this.headerFilters)return;b&&this.resetHeaderFilters(!1);if(arguments.length<3)var c=!0;var d=!1;for(var e in a)if(this.headerFilters.filterFields[e]){var f=this.headerFilters.filterFields[e];this.headerFilters.setFieldValue(f,a[e]),this.headerFilters.applyFilter(f,!1),d=!0}d&&c&&this.headerFilters.storeReload()},getHeaderFilterField:function(a){if(!this.headerFilters)return;return this.headerFilters.filterFields[a]?this.headerFilters.filterFields[a]:null},resetHeaderFilters:function(a){if(!this.headerFilters)return;if(arguments.length==0)var a=!0;for(var b in this.headerFilters.filterFields){var c=this.headerFilters.filterFields[b];Ext.isFunction(c.clearValue)?c.clearValue():this.headerFilters.setFieldValue(c,""),this.headerFilters.applyFilter(c,!1)}a&&this.headerFilters.storeReload()},applyHeaderFilters:function(a){if(arguments.length==0)var a=!0;this.headerFilters.applyFilters(a)}})},configure:function(a){var b=a.getColumnsBy(function(a){return Ext.isObject(a.filter)||Ext.isArray(a.filter)?!0:!1});this.fcc={};for(var c=0;c<b.length;c++){var d=b[c],e=d.filter;Ext.isArray(e)||(e=[e]);for(var f=0;f<e.length;f++){var g=Ext.apply({filterName:f>0?d.dataIndex+f:d.dataIndex},e[f]);Ext.apply(g,{columnId:d.id,dataIndex:d.dataIndex,hideLabel:Ext.isEmpty(g.fieldLabel),anchor:"100%"}),!this.cfgFilterInit&&!Ext.isEmpty(g.value)&&(this.filters[g.filterName]=Ext.isFunction(g.filterEncoder)?g.filterEncoder.call(this,g.value):g.value),delete g.value,g.applyFilterEvent?(g.listeners={scope:this},g.listeners[g.applyFilterEvent]=function(a){this.applyFilter(a)},delete g.applyFilterEvent):this.applyMode==="auto"||this.applyMode==="change"||Ext.isEmpty(this.applyMode)?g.listeners={change:function(a){var b=a.getXType();if(b=="combo"||b=="datefield")return;this.applyFilter(a)},specialkey:function(a,b){b.stopPropagation(),b.getKey()==b.ENTER&&a.el.dom.blur()},select:function(a){this.applyFilter(a)},scope:this}:this.applyMode==="enter"&&(g.listeners={specialkey:function(a,b){b.stopPropagation(),b.getKey()==b.ENTER&&this.applyFilters()},scope:this});var h=this.fcc[g.columnId];h||(h={cls:this.filterContainerCls,border:!1,bodyBorder:!1,labelSeparator:"",labelWidth:this.labelWidth,layout:"form",style:{},items:[]},this.containerConfig&&Ext.apply(h,this.containerConfig),this.fcc[g.columnId]=h),h.items.push(g)}}},renderFilterContainer:function(a,b){this.filterContainers||(this.filterContainers={});var c=this.grid.getColumnModel().getIndexById(a),d=this.grid.getView().getHeaderCell(c);d=Ext.get(d),Ext.isGecko&&(d.dom.style.MozUserSelect="text"),d.dom.style.verticalAlign="top",b.width=d.getWidth()-3;var e=new Ext.Container(b);e.render(d),this.filterContainers[a]=e;var f=0;this.filterFields||(this.filterFields={});var g=e.findBy(function(a){return!Ext.isEmpty(a.filterName)});if(!Ext.isEmpty(g))for(var h=0;h<g.length;h++){var i=g[h].filterName;this.filterFields[i]=g[h],f+=g[h].getHeight()}return e},renderFilters:function(){if(!this.fcc)return;for(var a in this.fcc)this.renderFilterContainer(a,this.fcc[a]);this.setFilters(this.filters),this.highlightFilters(this.isFiltered())},onRender:function(){this.renderFilters(),this.isFiltered()&&this.applyFilters(!1),this.fireEvent("render",this)},getFilterField:function(a){return this.filterFields?this.filterFields[a]:null},setFilters:function(a,b){this.filters=a;if(this.filters&&this.filterFields){for(var c in this.filters)this.filterFields[c]||delete this.filters[c];for(var c in this.filterFields){var d=this.filterFields[c],e=this.filters[d.filterName];Ext.isEmpty(e)?b&&this.setFieldValue(d,""):this.setFieldValue(d,e)}}},onColResize:function(a,b){if(!this.filterContainers)return;var c=this.grid.getColumnModel().getColumnId(a),d=this.filterContainers[c];if(d){isNaN(b)&&(b=0);var e=b<3?0:b-3;d.setWidth(e),d.doLayout(!1,!0)}},onResize:function(){var a=this.grid.getColumnModel().getColumnCount();for(var b=0;b<a;b++){var c=this.grid.getView().getHeaderCell(b);c=Ext.get(c),this.onColResize(b,c.getWidth())}},onColHidden:function(a,b,c){if(c)return;var d=this.grid.getColumnModel().getColumnWidth(b);this.onColResize(b,d)},onReconfigure:function(a,b,c){this.destroyFilters(),this.configure(c),this.renderFilters()},saveFilters:function(a,b){var c={};for(var d in this.filters)c[d]=this.filters[d];return b.gridHeaderFilters=c,!0},loadFilters:function(a,b){var c=b.gridHeaderFilters;c&&(this.cfgFilterInit?this.filtersInitMode==="merge"&&Ext.apply(c,this.filters):this.filters=c)},isFiltered:function(){for(var a in this.filters)if(!Ext.isEmpty(this.filters[a]))return!0;return!1},highlightFilters:function(a){if(!this.highlightOnFilter)return;if(!this.filterContainers)return;if(!this.grid.getView().mainHd)return;var b=this.grid.getView().mainHd.child(".x-grid3-hd-row");Ext.isEmpty(this.highlightCls)?b.setStyle("background-color",a?this.highlightColor:""):a?b.addClass(this.highlightCls):b.removeClass(this.highlightCls)},getFieldValue:function(a){return Ext.isFunction(a.filterEncoder)?a.filterEncoder.call(a,a.getValue()):a.getValue()},setFieldValue:function(a,b){Ext.isFunction(a.filterDecoder)&&(b=a.filterDecoder.call(a,b)),a.setValue(b)},applyFilter:function(a,b){arguments.length<2&&(b=!0);if(!a)return;if(!a.isValid())return;if(a.disabled&&!Ext.isDefined(this.grid.store.baseParams[a.filterName]))return;var c=this.getFieldValue(a);if(a.disabled||Ext.isEmpty(c))delete this.grid.store.baseParams[a.filterName],delete this.filters[a.filterName];else{this.grid.store.baseParams[a.filterName]=c,this.filters[a.filterName]=c;if(this.ensureFilteredVisible){var d=this.grid.getColumnModel().getIndexById(a.columnId);d>=0&&this.grid.getColumnModel().isHidden(d)&&this.grid.getColumnModel().setHidden(d,!1)}}this.highlightFilters(this.isFiltered()),this.grid.fireEvent("filterupdate",a.filterName,c,a),b&&this.storeReload()},applyFilters:function(a){arguments.length<1&&(a=!0);for(var b in this.filterFields)this.applyFilter(this.filterFields[b],!1);a&&this.storeReload()},storeReload:function(){if(!this.grid.store.lastOptions)return;var a={start:0};this.grid.store.lastOptions.params&&this.grid.store.lastOptions.params.limit&&(a.limit=this.grid.store.lastOptions.params.limit),this.grid
.store.load({params:a})},getFilterContainer:function(a){return this.filterContainers?this.filterContainers[a]:null},destroyFilters:function(){if(this.filterFields)for(var a in this.filterFields)Ext.destroy(this.filterFields[a]),delete this.filterFields[a];if(this.filterContainers)for(var a in this.filterContainers)Ext.destroy(this.filterContainers[a]),delete this.filterContainers[a]}});