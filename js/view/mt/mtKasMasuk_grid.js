jun.MtKasMasukGrid=Ext.extend(Ext.grid.GridPanel,{title:"Daftar Kas Masuk",id:"docs-jun.MtKasMasukGrid",iconCls:"silk-grid",viewConfig:{forceFit:!0},sm:new Ext.grid.RowSelectionModel({singleSelect:!0}),plugins:[new Ext.ux.grid.GridHeaderFilters],columns:[{header:"Ref. Dokumen",sortable:!0,resizable:!0,dataIndex:"doc_ref",width:100,filter:{xtype:"textfield"}},{header:"Tanggal Transaksi",sortable:!0,resizable:!0,dataIndex:"trans_date",width:100,filter:{xtype:"xdatefield",format:"Y-m-d"}},{header:"Terima Dari",sortable:!0,resizable:!0,dataIndex:"dari",width:100,filter:{xtype:"textfield"}},{header:"Jumlah",sortable:!0,resizable:!0,dataIndex:"amount",width:100,align:"right",renderer:Ext.util.Format.numberRenderer("0,0"),filter:{xtype:"numericfield"}}],initComponent:function(){this.store=jun.rztMtKasMasuk,this.bbar={items:[{xtype:"paging",store:this.store,displayInfo:!0,pageSize:20}]},this.tbar={xtype:"toolbar",items:[{xtype:"button",text:"Tambah Kas Masuk",ref:"../btnAdd"},{xtype:"tbseparator"},{xtype:"button",text:"Lihat Kas Masuk",ref:"../btnEdit"},{xtype:"tbseparator"},{xtype:"button",text:"Void Kas Masuk",ref:"../btnDelete"},{xtype:"tbseparator"},{xtype:"button",text:"Print",ref:"../btnPrint"}]},jun.rztMtKasMasuk.reload(),jun.MtKasMasukGrid.superclass.initComponent.call(this),this.btnAdd.on("Click",this.loadForm,this),this.btnEdit.on("Click",this.loadEditForm,this),this.btnDelete.on("Click",this.deleteRec,this),this.btnPrint.on("Click",this.print,this),this.getSelectionModel().on("rowselect",this.getrow,this)},print:function(){var a=this.sm.getSelected();if(a==""){Ext.MessageBox.alert("Warning","Anda belum memilih data kas masuk!");return}var b=a.json.kas_masuk_id;window.open("Mahkotrans/MtKasMasuk/print/id/"+b,"_blank")},getrow:function(a,b,c){this.record=c;var d=this.sm.getSelections()},loadForm:function(){var a=new jun.MtKasMasukWin({modez:0});a.show()},loadEditForm:function(){var a=this.sm.getSelected();if(a==""){Ext.MessageBox.alert("Warning","Anda belum memilih kas masuk");return}var b=a.json.kas_masuk_id,c=a.json.id_mobil;Ext.Ajax.request({url:"Mahkotrans/MtKasMasuk/view/",params:{id:b,id_mobil:c},method:"POST",success:function(a,c){var d=Ext.decode(a.responseText);if(d.success==0){Ext.MessageBox.show({title:"Warning",msg:d.msg,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING});return}var e=d.data[0],f=new jun.MtKasMasukShowWin({modez:1,id:b});f.txtRef.text=e.doc_ref,f.trans_entry.text=e.entry_time,f.dari.text=e.dari,f.trans_date.text=e.trans_date,f.kas.text=e.bank_account_name,f.mobil.text=e.nopol,f.amount.text=Ext.util.Format.number(e.amount,"0,0"),f.trans_via.text=e.trans_via,f.codeRek.text=e.account_code,f.codeDesc.text=e.description,f.show(this)},failure:function(a,b){Ext.MessageBox.alert("Error","Can't Communicate With The Server")}})},deleteRec:function(){var a=this.sm.getSelected();if(a==""){Ext.MessageBox.alert("Warning","Anda belum memilih kas masuk.");return}var b=a.json.kas_masuk_id,c=new jun.MtKasMasukVoidWin({id:b});c.show(this)}});