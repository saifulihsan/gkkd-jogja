jun.MtPinjamKendaraanGrid=Ext.extend(Ext.grid.GridPanel,{title:"Daftar Sewa",id:"docs-jun.MtPinjamKendaraanGrid",iconCls:"silk-grid",sm:new Ext.grid.RowSelectionModel({singleSelect:!0}),plugins:[new Ext.ux.grid.GridHeaderFilters],columns:[{header:"id_pinjam",sortable:!0,resizable:!0,dataIndex:"id_pinjam",hidden:!0,width:100},{header:"Ref. Dokumen",sortable:!0,resizable:!0,dataIndex:"doc_ref",width:100,filter:{xtype:"textfield",filterName:"doc_ref"}},{header:"Nama Pelanggan",sortable:!0,resizable:!0,dataIndex:"id_pelanggan",width:100,renderer:jun.renderMtPelanggan},{header:"No. Nopol",sortable:!0,resizable:!0,dataIndex:"id_mobil",width:100,renderer:jun.renderMtNopol},{header:"Tanggal Pinjam",sortable:!0,resizable:!0,dataIndex:"tgl_pinjam",width:150},{header:"Rencana Kembali",sortable:!0,resizable:!0,dataIndex:"tgl_rencana_kembali",width:150},{header:"Kelompok",sortable:!0,resizable:!0,dataIndex:"id_kelompok",width:100,renderer:jun.renderMtKelompokPelanggan},{header:"Total",sortable:!0,resizable:!0,dataIndex:"total_ongkos",width:100,align:"right",renderer:Ext.util.Format.numberRenderer("0,0")},{header:"DP",sortable:!0,resizable:!0,dataIndex:"dp",width:100,align:"right",renderer:Ext.util.Format.numberRenderer("0,0")},{header:"Sisa Tagihan",sortable:!0,resizable:!0,dataIndex:"sisa_tagihan",width:100,align:"right",renderer:Ext.util.Format.numberRenderer("0,0")}],initComponent:function(){jun.rztMtPelanggan.baseParams={},jun.rztMtPelanggan.load(),jun.rztMtPelanggan.baseParams={},jun.rztMtKelompokPelanggan.load(),jun.rztMtMobil.load(),jun.rztMtDriver.load(),jun.rztMtPinjamKendaraan.load(),jun.rztMtSysPrefs.load(),this.store=jun.rztMtPinjamKendaraan,this.bbar={items:[{xtype:"paging",store:this.store,displayInfo:!0,pageSize:20}]},this.tbar={xtype:"toolbar",items:[{xtype:"button",text:"Peminjaman",ref:"../btnAdd"},{xtype:"tbseparator"},{xtype:"button",text:"Lihat Peminjaman",ref:"../btnEdit"},{xtype:"tbseparator"},{xtype:"button",text:"Void Peminjaman",ref:"../btnDelete"},{xtype:"tbseparator"},{xtype:"button",text:"Pengembalian",ref:"../btnKembali"},{xtype:"tbseparator"},{xtype:"button",text:"Refresh",ref:"../btnRefresh"},{xtype:"tbseparator"},{xtype:"button",text:"Print",ref:"../btnPrint"}]},jun.MtPinjamKendaraanGrid.superclass.initComponent.call(this),this.btnAdd.on("Click",this.loadForm,this),this.btnEdit.on("Click",this.loadEditForm,this),this.btnDelete.on("Click",this.deleteRec,this),this.btnKembali.on("Click",this.kembaliForm,this),this.btnRefresh.on("Click",this.refreshData,this),this.btnPrint.on("Click",this.print,this),this.getSelectionModel().on("rowselect",this.getrow,this)},print:function(){var a=this.sm.getSelected();if(a==""){Ext.MessageBox.alert("Warning","Anda belum memilih data peminjaman!");return}var b=a.json.id_pinjam;window.open("Mahkotrans/MtPinjamKendaraan/print/id/"+b,"_blank")},refreshData:function(){jun.rztMtPelanggan.baseParams={mode:"all"},jun.rztMtPelanggan.load(),jun.rztMtPelanggan.baseParams={},jun.rztMtPinjamKendaraan.reload()},getrow:function(a,b,c){this.record=c;var d=this.sm.getSelections()},loadForm:function(){var a=new jun.MtPinjamanWin({modez:0});a.show()},loadEditForm:function(){var a=this.sm.getSelected();if(a==""){Ext.MessageBox.alert("Warning","Anda belum memilih data peminjaman!");return}var b=a.json.id_pinjam,c=new jun.MtPinjamanWin({modez:1});c.show(this),c.formz.getForm().loadRecord(this.record);var d=Date.parseDate(this.record.data.tgl_pinjam,"Y-n-j H:i:s");c.tgl_pinjam.setValue(d);var e=Date.parseDate(this.record.data.tgl_rencana_kembali,"Y-n-j H:i:s");c.rencana_tanggal_kembali.setValue(e);var f=jun.getMobil(this.record.data.id_mobil);c.jenis_mobil.setValue(f.data.jenis)},kembaliForm:function(){var a=this.sm.getSelected();if(a==""){Ext.MessageBox.alert("Warning","Anda belum memilih mobil yang dipinjam.");return}if(this.record.data.is_back=="1"){Ext.MessageBox.alert("Warning","Kendaraan sudah dikembalikan");return}var b=a.json.id_pinjam,c=new jun.MtPengembalianWin({modez:0});c.show(this),c.formz.getForm().loadRecord(this.record);var d=Date.parseDate(this.record.data.tgl_pinjam,"Y-n-j H:i:s");c.tgl_pinjam.setValue(d);var e=Date.parseDate(this.record.data.tgl_rencana_kembali,"Y-n-j H:i:s");c.rencana_tanggal_kembali.setValue(e),c.trans_date.setValue(new Date);var f=jun.getMobil(this.record.data.id_mobil);c.jenis_mobil.setValue(f.data.jenis),c.no_bukti_bayar.setValue(""),c.trans_via.setValue("Tunai")},deleteRec:function(){var a=this.sm.getSelected();if(a==""){Ext.MessageBox.alert("Warning","Anda belum memilih mobil yang dipinjam.");return}if(this.record.data.is_back=="1"){Ext.MessageBox.alert("Warning","Kendaraan sudah dikembalikan");return}var b=a.json.id_pinjam,c=new jun.MtPinjamVoidWin({id:b});c.show(this)}});