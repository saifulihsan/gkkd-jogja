vbGeneralDate=0,vbLongDate=1,vbShortDate=2,vbLongTime=3,vbShortTime=4,vbUseSystemDayOfWeek=0,vbSunday=1,vbMonday=2,vbTuesday=3,vbWednesday=4,vbThursday=5,vbFriday=6,vbSaturday=7,vbUseSystem=0,vbFirstJan1=1,vbFirstFourDays=2,vbFirstFullWeek=3,Date.MonthNames=[null,"January","February","March","April","May","June","July","August","September","October","November","December"],Date.WeekdayNames=[null,"Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.IsDate=function(a){return!isNaN(new Date(a))},Date.CDate=function(a){if(Date.IsDate(a))return new Date(a);var b=a.replace(/\-/g,"/").replace(/\./g,"/").replace(/ /g,"/");b=b.replace(/pm$/i," pm").replace(/am$/i," am");if(Date.IsDate(b))return new Date(b);var c=b+"/"+(new Date).getFullYear();if(Date.IsDate(c))return new Date(c);if(b.indexOf(":")){var d=b.replace(/ /,"/"+(new Date).getFullYear()+" ");if(Date.IsDate(d))return new Date(d);var e=(new Date).toDateString()+" "+a;if(Date.IsDate(e))return new Date(e)}return!1},Date.DateAdd=function(a,b,c){if(!Date.CDate(c))return"invalid date: '"+c+"'";if(isNaN(b))return"invalid number: '"+b+"'";b=new Number(b);var d=Date.CDate(c);switch(a.toLowerCase()){case"yyyy":d.setFullYear(d.getFullYear()+b);break;case"q":d.setMonth(d.getMonth()+b*3);break;case"m":d.setMonth(d.getMonth()+b);break;case"y":case"d":case"w":d.setDate(d.getDate()+b);break;case"ww":d.setDate(d.getDate()+b*7);break;case"h":d.setHours(d.getHours()+b);break;case"n":d.setMinutes(d.getMinutes()+b);break;case"s":d.setSeconds(d.getSeconds()+b);break;case"ms":d.setMilliseconds(d.getMilliseconds()+b);break;default:return"invalid interval: '"+a+"'"}return d},Date.DateDiff=function(a,b,c,d){if(!Date.CDate(b))return"invalid date: '"+b+"'";if(!Date.CDate(c))return"invalid date: '"+c+"'";d=isNaN(d)||d==0?vbSunday:parseInt(d);var e=Date.CDate(b),f=Date.CDate(c);"h,n,s,ms".indexOf(a.toLowerCase())==-1&&(b.toString().indexOf(":")==-1&&e.setUTCHours(0,0,0,0),c.toString().indexOf(":")==-1&&f.setUTCHours(0,0,0,0));var g=f.valueOf()-e.valueOf(),h=new Date(g),i=f.getUTCFullYear()-e.getUTCFullYear(),j=f.getUTCMonth()-e.getUTCMonth()+(i!=0?i*12:0),k=parseInt(j/3),l=g,m=parseInt(g/1e3),n=parseInt(m/60),o=parseInt(n/60),p=parseInt(o/24),q=parseInt(p/7);if(a.toLowerCase()=="ww"){var r=Date.DatePart("w",e,d)-1;r&&e.setDate(e.getDate()+7-r);var r=Date.DatePart("w",f,d)-1;r&&f.setDate(f.getDate()-r);var s=Date.DateDiff("w",e,f)+1}switch(a.toLowerCase()){case"yyyy":return i;case"q":return k;case"m":return j;case"y":case"d":return p;case"w":return q;case"ww":return s;case"h":return o;case"n":return n;case"s":return m;case"ms":return l;default:return"invalid interval: '"+a+"'"}},Date.DatePart=function(a,b,c){if(!Date.CDate(b))return"invalid date: '"+b+"'";var d=Date.CDate(b);switch(a.toLowerCase()){case"yyyy":return d.getFullYear();case"q":return parseInt(d.getMonth()/3)+1;case"m":return d.getMonth()+1;case"y":return Date.DateDiff("y","1/1/"+d.getFullYear(),d)+1;case"d":return d.getDate();case"w":return Date.Weekday(d.getDay()+1,c);case"ww":return Date.DateDiff("ww","1/1/"+d.getFullYear(),d,c)+1;case"h":return d.getHours();case"n":return d.getMinutes();case"s":return d.getSeconds();case"ms":return d.getMilliseconds();default:return"invalid interval: '"+a+"'"}},Date.MonthName=function(a,b){if(isNaN(a)){if(!Date.CDate(a))return"invalid month: '"+a+"'";a=DatePart("m",Date.CDate(a))}var c=Date.MonthNames[a];return b==1&&(c=c.substring(0,3)),c},Date.WeekdayName=function(a,b,c){if(isNaN(a)){if(!Date.CDate(a))return"invalid weekday: '"+a+"'";a=DatePart("w",Date.CDate(a))}c=isNaN(c)||c==0?vbSunday:parseInt(c);var d=(c-1+parseInt(a)-1+7)%7+1,e=Date.WeekdayNames[d];return b==1&&(e=e.substring(0,3)),e},Date.Weekday=function(a,b){return b=isNaN(b)||b==0?vbSunday:parseInt(b),(parseInt(a)-b+7)%7+1},Date.FormatDateTime=function(a,b){a.toUpperCase().substring(0,3)=="NOW"&&(a=new Date);if(!Date.CDate(a))return"invalid date: '"+a+"'";isNaN(b)&&(b=vbGeneralDate);var c=Date.CDate(a);switch(parseInt(b)){case vbGeneralDate:return c.toString();case vbLongDate:return Format(a,"DDDD, MMMM D, YYYY");case vbShortDate:return Format(a,"MM/DD/YYYY");case vbLongTime:return c.toLocaleTimeString();case vbShortTime:return Format(a,"HH:MM:SS");default:return"invalid NamedFormat: '"+b+"'"}},Date.Format=function(a,b,c,d){if(!Date.CDate(a))return"invalid date: '"+a+"'";if(!b||b=="")return e.toString();var e=Date.CDate(a);this.pad=function(a){return a.toString().length==1&&(a="0"+a),a};var f=e.getHours()>=12?"PM":"AM",g=e.getHours();g==0&&(g=12),g>12&&(g-=12);var h=g+":"+this.pad(e.getMinutes())+":"+this.pad(e.getSeconds())+" "+f,i=e.getMonth()+1+"/"+e.getDate()+"/"+(new String(e.getFullYear())).substring(2,4),j=Date.MonthName(e.getMonth()+1)+" "+e.getDate()+", "+e.getFullYear(),k=b;return k=k.replace(new RegExp("C","gi"),"CCCC"),k=k.replace(new RegExp("mmmm","gi"),"XXXX"),k=k.replace(new RegExp("mmm","gi"),"XXX"),k=k.replace(new RegExp("dddddd","gi"),"AAAAAA"),k=k.replace(new RegExp("ddddd","gi"),"AAAAA"),k=k.replace(new RegExp("dddd","gi"),"AAAA"),k=k.replace(new RegExp("ddd","gi"),"AAA"),k=k.replace(new RegExp("timezone","gi"),"ZZZZ"),k=k.replace(new RegExp("time24","gi"),"TTTT"),k=k.replace(new RegExp("time","gi"),"TTT"),k=k.replace(new RegExp("yyyy","gi"),e.getFullYear()),k=k.replace(new RegExp("yy","gi"),(new String(e.getFullYear())).substring(2,4)),k=k.replace(new RegExp("y","gi"),Date.DatePart("y",e)),k=k.replace(new RegExp("q","gi"),Date.DatePart("q",e)),k=k.replace(new RegExp("mm","gi"),e.getMonth()+1),k=k.replace(new RegExp("m","gi"),e.getMonth()+1),k=k.replace(new RegExp("dd","gi"),this.pad(e.getDate())),k=k.replace(new RegExp("d","gi"),e.getDate()),k=k.replace(new RegExp("hh","gi"),this.pad(e.getHours())),k=k.replace(new RegExp("h","gi"),e.getHours()),k=k.replace(new RegExp("nn","gi"),this.pad(e.getMinutes())),k=k.replace(new RegExp("n","gi"),e.getMinutes()),k=k.replace(new RegExp("ss","gi"),this.pad(e.getSeconds())),k=k.replace(new RegExp("s","gi"),e.getSeconds()),k=k.replace(new RegExp("t t t t t","gi"),h),k=k.replace(new RegExp("am/pm","g"),e.getHours()>=12?"pm":"am"),k=k.replace(new RegExp("AM/PM","g"),e.getHours()>=12?"PM":"AM"),k=k.replace(new RegExp("a/p","g"),e.getHours()>=12?"p":"a"),k=k.replace(new RegExp("A/P","g"),e.getHours()>=12?"P":"A"),k=k.replace(new RegExp("AMPM","g"),e.getHours()>=12?"pm":"am"),k=k.replace(new RegExp("XXXX","gi"),Date.MonthName(e.getMonth()+1,!1)),k=k.replace(new RegExp("XXX","gi"),Date.MonthName(e.getMonth()+1,!0)),k=k.replace(new RegExp("AAAAAA","gi"),j),k=k.replace(new RegExp("AAAAA","gi"),i),k=k.replace(new RegExp("AAAA","gi"),Date.WeekdayName(e.getDay()+1,!1,c)),k=k.replace(new RegExp("AAA","gi"),Date.WeekdayName(e.getDay()+1,!0,c)),k=k.replace(new RegExp("TTTT","gi"),e.getHours()+":"+this.pad(e.getMinutes())),k=k.replace(new RegExp("TTT","gi"),g+":"+this.pad(e.getMinutes())+" "+f),k=k.replace(new RegExp("CCCC","gi"),i+" "+h),tz=e.getTimezoneOffset(),timezone=tz<0?"GMT-"+tz/60:tz==0?"GMT":"GMT+"+tz/60,k=k.replace(new RegExp("ZZZZ","gi"),timezone),k},IsDate=Date.IsDate,CDate=Date.CDate,DateAdd=Date.DateAdd,DateDiff=Date.DateDiff,DatePart=Date.DatePart,MonthName=Date.MonthName,WeekdayName=Date.WeekdayName,Weekday=Date.Weekday,FormatDateTime=Date.FormatDateTime,Format=Date.Format;